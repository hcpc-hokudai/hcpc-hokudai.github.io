# HCPC 北海道大学競技プログラミングサークル

**!!! 工事中です !!!**

- [移行先予定のホームページはこちら](https://hcpc-hokudai.github.io/)
- [現行のホームページはこちら](http://hcpc.web.fc2.com/)

## 注意 (編集者向け)

- `Gemfile` および `Gemfile.lock` は gem パッケージの管理に必要なファイルです。取扱にはご注意ください
- ~~GitHub Pages では jekyll ページの build は自動でやってくれます。なので、`_site` ディレクトリは push する必要がありません~~
    - ~~`.gitignore` で push しない設定にしてあります~~
    - **plugin の関係で自動 build が使用できなくなったため、以下の「ビルドについて (編集者向け)」を読んでください**
    
## ビルドについて (編集者向け)
`<details>` タグはそのままではうまく変換されないため、ユーザー指定の plugin も利用してビルドを行います。しかし、GitHub Pages 上では利用可能な plugin が限定されているためにビルドできません。これを回避するために、以下の手順を踏んでページを公開することにしています。
1. `src` ディレクトリに行き、自分の (ローカルな) 環境で `jekyll buiid` し、公開用のファイルを作成
1. 作成されたファイルを root (最も上の階層) へ移動
1. 不要なファイルがいくつか含まれているので削除

毎回手で行うのは大変なので、例えば次のようなスクリプトを用意すると良いです (下のコードを `run.sh` とかにして root に保存して使う)

``` bash
ls | grep -v -E "^README.md|^LICENSE|^docs|^src|^run.sh" | xargs rm -rf # 元々ビルドされていたものを消す (いるものを消さないように注意)
cd src/
bundle exec jekyll clean # _site ディレクトリを消す
bundle exec jekyll build # ビルドして _site ディレクトリを生成
mv _site/* ../ # _site の中身を全て root に移動

cd -
rm -rf jekyll-theme-cayman-blog.gemspec script # .gitignore でどうせ除外されるので、あまり必要ない
```

GitHub Pages を使う恩恵がもはやないのですが、自分で入れた plugin を使おうとするとこれ以外に方法がないので仕方がないという状況です。公式で用意されている plugin で同等の機能があるなど、解決策が見つかり次第対応しようとは思います。

## 更新方法

### ページの追加

About ページや Contact のページのように、比較的上の階層をページを作るときについてです。例として、`section.md` というファイル名の `Section` というタイトルのページを作ることを考えます。

まず、`src` フォルダに `section.md` ファイルを作ります。

他のファイルを見てみると分かるかと思いますが、先頭に YAML 形式で、そのページに関する情報を記載する必要があります。例えば、以下のような情報を入力します。

|種類|説明|
|---|---|
|layout|ページレイアウトを指定します (今回の場合は `page` です)|
|title|ページタイトルです。ページの大見出しになります|
|header-title|ホームページの header に記載されるテキストです|
|tagline|大見出しの下に記載される文章です|
|ref|他のテキストファイルから参照できるよう、作成したページのアドレスを指定します。原則、ファイル名と同じにしてください。|

YAML 形式の情報記載が済みましたら、その下に本文を Markdown 形式で記載します。HTML タグも使用可能です。

### 記事の追加

ICPC 参加報告などの記事を記載する場合は、以下の手順を踏むと編集しやすいと思います。

- ローカルで `jekyll` を使えるように環境を作ります。詳しくは [公式ページ](http://jekyllrb-ja.github.io/) などを参考にしてください。
- `jekyll serve --trace` などを叩き、ローカルで Web ページが見れるようにします。たとえば `http://localhost:4000` で見られるとします。
- ブラウザで `http://localhost:4000/admin/` を見に行きます。
- すると、管理画面のようなものにたどり着くはずです。
    - https://hcpc-hokudai.github.io/admin/ と打ってもアクセスできないことに注意します。あくまで、ローカル限定の機能です。
- ページ左にあります「Posts」をクリックします。
- すでにある記事の一覧と、「New post」ボタンがあると思いますので、「New post」をクリックします。
- 以下に従って記事を書きます。
    - `Path` は `yyyy-mm-dd-title.md` の形式で書きます。`yyyy-mm-dd` は投稿日時を表し、`title` はその記事の URL の一部になりますので、英数字のみで書いてください。
    - `Title` は記事タイトルを書きます。日本語でも英語でもよいです。
    - その下にありますテキストボックスは本文を記載するところです。Markdown 形式で書いてください。プレビューもできます。
    - さらに下に Metadata Field というものがあります。これは、先程「ページの追加」で書いた YAML 形式のデータを書く欄です。
        - `layout: post` は最低限書いてください。これを書かないと記事スタイルが崩壊します。
